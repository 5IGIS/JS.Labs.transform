/* labs!transform 0.7.9 */
function sender(a){var b;if(!a)var a=window.event;return a.target?b=a.target:a.srcElement&&(b=a.srcElement),3==b.nodeType&&(b=b.parentNode),b}var Defaults={defaultHeight:450,maxHeight:450,defaultWidth:450,maxWidth:450,defaultTop:20,maxTop:450,defaultLeft:20,maxLeft:450,defaultPerspective:1e4,maxPerspective:1e4,defaultRotate:0,maxRotate:360,defaultTranslate:0,maxTranslate:450,defaultOrigin:50,maxOrigin:100},defaultPropertyControls=[{key:"widthControl",name:"width",unit:"px",url:"http://www.w3schools.com/cssref/pr_dim_width.asp",title:"The width property sets the width of an element.",min:0,max:Defaults.maxWidth,value:Defaults.defaultWidth,delegate:null},{key:"heightControl",name:"height",unit:"px",url:"http://www.w3schools.com/cssref/pr_dim_height.asp",title:"The height property sets the height of an element.",min:0,max:Defaults.maxHeight,value:Defaults.defaultHeight,delegate:null},{key:"topControl",name:"top",unit:"px",url:"http://www.w3schools.com/cssref/pr_pos_top.asp",title:"For absolutely positioned elements, the top property sets the top edge of an element to a unit above/below the top edge of its containing element. For relatively positioned elements, the top property sets the top edge of an element to a unit above/below its normal position.",min:0,max:Defaults.maxTop,value:Defaults.defaultTop,delegate:null},{key:"leftControl",name:"left",unit:"px",url:"http://www.w3schools.com/cssref/pr_pos_left.asp",title:"For absolutely positioned elements, the left property sets the left edge of an element to a unit to the left/right of the left edge of its containing element. For relatively positioned elements, the left property sets the left edge of an element to a unit to the left/right to its normal position.",min:0,max:Defaults.maxLeft,value:Defaults.defaultLeft,delegate:null}],defaultPropertyValueControls={"-webkit-transform":[{key:"perspectiveControl",name:"perspective",unit:"",url:"http://www.w3schools.com/css3/css3_3dtransforms.asp",title:"Defines a perspective view for a 3D transformed element",min:0,max:Defaults.maxPerspective,value:Defaults.defaultPerspective,className:"TransformValueControl",delegate:null},{key:"rotateXControl",name:"rotateX",unit:"deg",url:"http://www.w3schools.com/css3/css3_3dtransforms.asp",title:"Defines a 3D rotation along the X-axis.",min:0,max:Defaults.maxRotate,value:Defaults.defaultRotate,className:"TransformValueControl",delegate:null},{key:"rotateYControl",name:"rotateY",unit:"deg",url:"http://www.w3schools.com/css3/css3_3dtransforms.asp",title:"Defines a 3D rotation along the Y-axis.",min:0,max:Defaults.maxRotate,value:Defaults.defaultRotate,className:"TransformValueControl",delegate:null},{key:"rotateZControl",name:"rotateZ",unit:"deg",url:"http://www.w3schools.com/css3/css3_3dtransforms.asp",title:"Defines a 3D rotation along the Z-axis.",min:0,max:Defaults.maxRotate,value:Defaults.defaultRotate,className:"TransformValueControl",delegate:null},{key:"translateXControl",name:"translateX",unit:"px",url:"http://www.w3schools.com/css3/css3_3dtransforms.asp",title:"Defines a translation, using only the value for the X-axis.",min:0,max:Defaults.maxTranslate,value:Defaults.defaultTranslate,className:"TransformValueControl",delegate:null},{key:"translateYControl",name:"translateY",unit:"px",url:"http://www.w3schools.com/css3/css3_3dtransforms.asp",title:"Defines a translation, using only the value for the X-axis.",min:0,max:Defaults.maxTranslate,value:Defaults.defaultTranslate,className:"TransformValueControl",delegate:null},{key:"translateZControl",name:"translateZ",unit:"px",url:"http://www.w3schools.com/css3/css3_3dtransforms.asp",title:"Defines a 3D translation, using only the value for the Z-axis.",min:0,max:Defaults.maxTranslate,value:Defaults.defaultTranslate,className:"TransformValueControl",delegate:null}],"-webkit-transform-origin":[{key:"originXControl",name:"originX",unit:"%",url:"http://www.w3schools.com/cssref/css3_pr_transform-origin.asp",title:"Set a rotated element's base placement.",min:0,max:Defaults.maxOrigin,value:Defaults.defaultOrigin,className:"PercentValueControl",delegate:null},{key:"originYControl",name:"originY",unit:"%",url:"http://www.w3schools.com/cssref/css3_pr_transform-origin.asp",title:"Set a rotated element's base placement.",min:0,max:Defaults.maxOrigin,value:Defaults.defaultOrigin,className:"PercentValueControl",delegate:null}]},TRPropertyControl=Class.extend({construct:function(a,b){this.parentPropertyName=b||"";var c=b?".":"";this.key=a.key,this.keyPath=this.parentPropertyName+c+this.key,this.name=a.name,this.unit=a.unit,this.url=a.url,this.title=a.title,this.min=a.min,this.max=a.max,this.step=a.step||1,this.value=a.value,this.delegate=a.delegate,this.valueTextField=null,this.element=this.createElement()},createElement:function(){var a=document.createElement("div");a.className="variable";var b=document.createElement("a");b.href=this.url,b.title=this.title,b.target="_blank";var c=document.createElement("label");c.className="name",c.innerHTML=this.name,this.slider=document.createElement("input"),this.slider.id=this.name+"Slider",this.slider.className="range",this.slider.type="range",this.slider.min=this.min,this.slider.max=this.max,this.slider.step=this.step,this.slider.value=this.value,this.slider.onchange=this.sliderValueChanged.bind(this),this.slider.onmouseup=this.sliderReleased.bind(this),this.slider.dataset.keyPath=this.keyPath,this.valueTextField=document.createElement("input"),this.valueTextField.id=this.name+"ValueTextField",this.valueTextField.className="value",this.valueTextField.value=this.value,this.valueTextField.onchange=this.valueTextField.onkeydown=this.valueTextField.onkeyup=this.textFieldValueChanged.bind(this),this.valueTextField.dataset.keyPath=this.keyPath;var d=document.createElement("label");return d.className="unit",d.innerHTML=this.unit,a.appendChild(b),b.appendChild(c),a.appendChild(this.slider),a.appendChild(this.valueTextField),a.appendChild(d),a},cssValue:function(){return this.name+": "+this.value+this.unit+";"},sliderValueChanged:function(a){slider=sender(a),log(slider.dataset.keyPath),control=viewController.controlForKeyPath(slider.dataset.keyPath),control.value=slider.value,control.valueTextField.value=slider.value,control.delegate.sliderValueChanged(a)},sliderReleased:function(a){slider=sender(a),control=viewController.controlForKeyPath(slider.dataset.keyPath),control.delegate.sliderReleased(a)},textFieldValueChanged:function(a){textField=sender(a),control=viewController.controlForKeyPath(textField.dataset.keyPath),control.value=textField.value,control.slider.value=textField.value,control.delegate.textFieldValueChanged(a)}}),TransformValueControl=TRPropertyControl.extend({cssValue:function(){return this.name+"("+this.value+this.unit+")"}}),PercentValueControl=TRPropertyControl.extend({cssValue:function(){return this.value+"%"}}),TRViewController=Class.extend({construct:function(){this.propertiesPanel=document.getElementById("propertiesPanel"),this.cssTextArea=document.getElementById("cssTextArea"),this.dummy=document.getElementById("dummy"),this.properyControls=[],this.cssText=""},build:function(){this.addPropertyControls(defaultPropertyControls),this.addPropertyValueControls(defaultPropertyValueControls),this.sliderValueChanged()},addNewPropertyControl:function(a){var b=a.className||"TRPropertyControl";control=new window[b](a),this.properyControls[control.keyPath]=control,this.propertiesPanel.appendChild(control.element)},addPropertyControls:function(a){a.enumerate(function(a){a.delegate=viewController,viewController.addNewPropertyControl(a)})},addNewPropertyValueControl:function(a,b){var c=b.className||"TRTRPropertyControl";control=new window[c](b,a),null==this.properyControls[a]&&(this.properyControls[a]=[]),this.properyControls.setValueForKeyPath(control,control.keyPath),this.propertiesPanel.appendChild(control.element)},addPropertyValueControls:function(a){a.enumerate(function(a,b){a.enumerate(function(a){a.delegate=viewController,viewController.addNewPropertyValueControl(b,a)})})},controlForKeyPath:function(a){return this.properyControls.valueForKeyPath(a)},cssRule:function(){var a="";return this.properyControls.enumerate(function(b,c){log("eachControlOrPropertyValues: "+b),b instanceof Array?(cssDefinition="",document.cssValues=[],b.enumerate(function(a){document.cssValues.push(a.cssValue())}),cssDefinition=document.cssValues.join(" "),a+=c+": "+cssDefinition+"; \n"):(eachControl=b,a+=eachControl.cssValue()+" \n")}),a},sliderValueChanged:function(){this.cssText=this.cssRule(),this.cssTextArea.value=this.cssText,this.apply()},sliderReleased:function(){},textFieldValueChanged:function(){this.cssText=this.cssRule(),this.cssTextArea.value=this.cssText,this.apply()},apply:function(){this.dummy.style.cssText=this.cssRule()}}),Matrix3D=Class.extend({m11:1,m12:0,m13:0,m14:0,m21:0,m22:1,m23:0,m24:0,m31:0,m32:0,m33:1,m34:0,m41:0,m42:0,m43:0,m44:1,map:["m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44"],string:"",div:null,construct:function(a){null!=a&&this.enumerateMap(function(b,c){this[b]=a[c]})},update:function(){this.string=this.toCSSString()},toCSSString:function(){return"matrix3d("+this.m11+", "+this.m21+", "+this.m31+", "+this.m41+", "+this.m12+", "+this.m22+", "+this.m32+", "+this.m42+", "+this.m13+", "+this.m23+", "+this.m33+", "+this.m43+", "+this.m14+", "+this.m24+", "+this.m34+", "+this.m44+")"},translate:function(a,b,c){this.m14=a,this.m24=b,this.m34=c,this.update()},translateX:function(a){this.m14=a,this.update()},translateY:function(a){this.m24=a,this.update()},translateZ:function(a){this.m24=a,this.update()},degrees:function(a){return a*(180/Math.PI)},radians:function(a){return a*(Math.PI/180)},rotateX:function(a){radians=this.radians(a),sin=Math.sin(radians),cos=Math.cos(radians),this.m22=cos,this.m23=-sin,this.m32=sin,this.m33=cos,this.update()},rotateY:function(a){radians=this.radians(a),sin=Math.sin(radians),cos=Math.cos(radians),this.m11=cos,this.m13=sin,this.m31=-sin,this.m33=cos,this.update()},rotateZ:function(a){radians=this.radians(a),sin=Math.sin(radians),cos=Math.cos(radians),this.m11=cos,this.m12=-sin,this.m21=sin,this.m22=cos,this.update()}},{identy:function(){return new this}},{string:["div.style.webkitTransform","%"]}),EPPZViewPropertyMap={top:["div.style.top","%px"],left:["div.style.left","%px"],width:["div.style.width","%px"],height:["div.style.height","%px"],color:["div.style.backgroundColor","%"],image:["div.style.backgroundImage","url(%)"],overflow:["div.style.overflow","%"]},EPPZView=Class.extend({className:"EPPZView",id:"",top:0,left:0,widht:0,height:0,color:"black",image:null,overflow:"hidden",matrix3D:null,div:null,superview:null,subviews:[],construct:function(a){this.id=a,this.subviews=[],this.matrix3D=Matrix3D.identy(),this.build(),this.addActions(),this.update(),this.matrix3D.div=this.div},build:function(){var a=elementOfType("div");a.id=this.id,a.className=this.className,a.style.position="absolute",a.style.backgroundColor=this.color,this.image&&(a.style.backgroundImage="url("+this.image+")"),this.div=a,this.div.view=this},update:function(){},addToBody:function(){document.body.appendChild(this.div)},addSubview:function(a){this.subviews.push(a),a.superview=this,this.div.appendChild(a.div)},addActions:function(){this.div.onmouseover=this.mouseOver.bind(this),this.div.onmouseout=this.mouseOut.bind(this),this.div.onclick=this.onClick.bind(this),this.div.onmousedown=this.mouseDown.bind(this),this.div.onmousemove=this.mouseMove.bind(this),this.div.onmouseup=this.mouseUp.bind(this)},mouseOver:function(){},mouseOut:function(){},onClick:function(){},mouseDown:function(){},mouseMove:function(){},mouseUp:function(){}}),Matrix3D=Class.extend({m11:1,m12:0,m13:0,m14:0,m21:0,m22:1,m23:0,m24:0,m31:0,m32:0,m33:1,m34:0,m41:0,m42:0,m43:0,m44:1,map:["m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44"],string:"",div:null,construct:function(a){null!=a&&this.enumerateMap(function(b,c){this[b]=a[c]})},update:function(){this.string=this.toCSSString()},toCSSString:function(){return"matrix3d("+this.m11+", "+this.m21+", "+this.m31+", "+this.m41+", "+this.m12+", "+this.m22+", "+this.m32+", "+this.m42+", "+this.m13+", "+this.m23+", "+this.m33+", "+this.m43+", "+this.m14+", "+this.m24+", "+this.m34+", "+this.m44+")"},translate:function(a,b,c){this.m14=a,this.m24=b,this.m34=c,this.update()},translateX:function(a){this.m14=a,this.update()},translateY:function(a){this.m24=a,this.update()},translateZ:function(a){this.m24=a,this.update()},degrees:function(a){return a*(180/Math.PI)},radians:function(a){return a*(Math.PI/180)},rotateX:function(a){radians=this.radians(a),sin=Math.sin(radians),cos=Math.cos(radians),this.m22=cos,this.m23=-sin,this.m32=sin,this.m33=cos,this.update()},rotateY:function(a){radians=this.radians(a),sin=Math.sin(radians),cos=Math.cos(radians),this.m11=cos,this.m13=sin,this.m31=-sin,this.m33=cos,this.update()},rotateZ:function(a){radians=this.radians(a),sin=Math.sin(radians),cos=Math.cos(radians),this.m11=cos,this.m12=-sin,this.m21=sin,this.m22=cos,this.update()}},{identy:function(){return new this}},{string:["div.style.webkitTransform","%"]}),EPPZViewPropertyMap={top:["div.style.top","%px"],left:["div.style.left","%px"],width:["div.style.width","%px"],height:["div.style.height","%px"],color:["div.style.backgroundColor","%"],image:["div.style.backgroundImage","url(%)"],overflow:["div.style.overflow","%"]},EPPZView=Class.extend({className:"EPPZView",id:"",top:0,left:0,widht:0,height:0,color:"black",image:null,overflow:"hidden",matrix3D:null,div:null,superview:null,subviews:[],construct:function(a){this.id=a,this.subviews=[],this.matrix3D=Matrix3D.identy(),this.build(),this.addActions(),this.update(),this.matrix3D.div=this.div},build:function(){var a=elementOfType("div");a.id=this.id,a.className=this.className,a.style.position="absolute",a.style.backgroundColor=this.color,this.image&&(a.style.backgroundImage="url("+this.image+")"),this.div=a,this.div.view=this},update:function(){},addToBody:function(){document.body.appendChild(this.div)},addSubview:function(a){this.subviews.push(a),a.superview=this,this.div.appendChild(a.div)},addActions:function(){this.div.onmouseover=this.mouseOver.bind(this),this.div.onmouseout=this.mouseOut.bind(this),this.div.onclick=this.onClick.bind(this),this.div.onmousedown=this.mouseDown.bind(this),this.div.onmousemove=this.mouseMove.bind(this),this.div.onmouseup=this.mouseUp.bind(this)},mouseOver:function(){},mouseOut:function(){},onClick:function(){},mouseDown:function(){},mouseMove:function(){},mouseUp:function(){}}),Matrix3D=Class.extend({m11:1,m12:0,m13:0,m14:0,m21:0,m22:1,m23:0,m24:0,m31:0,m32:0,m33:1,m34:0,m41:0,m42:0,m43:0,m44:1,map:["m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44"],string:"",div:null,construct:function(a){null!=a&&this.enumerateMap(function(b,c){this[b]=a[c]})},update:function(){this.string=this.toCSSString()},toCSSString:function(){return"matrix3d("+this.m11+", "+this.m21+", "+this.m31+", "+this.m41+", "+this.m12+", "+this.m22+", "+this.m32+", "+this.m42+", "+this.m13+", "+this.m23+", "+this.m33+", "+this.m43+", "+this.m14+", "+this.m24+", "+this.m34+", "+this.m44+")"},translate:function(a,b,c){this.m14=a,this.m24=b,this.m34=c,this.update()},translateX:function(a){this.m14=a,this.update()},translateY:function(a){this.m24=a,this.update()},translateZ:function(a){this.m24=a,this.update()},degrees:function(a){return a*(180/Math.PI)},radians:function(a){return a*(Math.PI/180)},rotateX:function(a){radians=this.radians(a),sin=Math.sin(radians),cos=Math.cos(radians),this.m22=cos,this.m23=-sin,this.m32=sin,this.m33=cos,this.update()},rotateY:function(a){radians=this.radians(a),sin=Math.sin(radians),cos=Math.cos(radians),this.m11=cos,this.m13=sin,this.m31=-sin,this.m33=cos,this.update()},rotateZ:function(a){radians=this.radians(a),sin=Math.sin(radians),cos=Math.cos(radians),this.m11=cos,this.m12=-sin,this.m21=sin,this.m22=cos,this.update()}},{identy:function(){return new this}},{string:["div.style.webkitTransform","%"]}),EPPZViewPropertyMap={top:["div.style.top","%px"],left:["div.style.left","%px"],width:["div.style.width","%px"],height:["div.style.height","%px"],color:["div.style.backgroundColor","%"],image:["div.style.backgroundImage","url(%)"],overflow:["div.style.overflow","%"]},EPPZView=Class.extend({className:"EPPZView",id:"",top:0,left:0,widht:0,height:0,color:"black",image:null,overflow:"hidden",matrix3D:null,div:null,superview:null,subviews:[],construct:function(a){this.id=a,this.subviews=[],this.matrix3D=Matrix3D.identy(),this.build(),this.addActions(),this.update(),this.matrix3D.div=this.div},build:function(){var a=elementOfType("div");a.id=this.id,a.className=this.className,a.style.position="absolute",a.style.backgroundColor=this.color,this.image&&(a.style.backgroundImage="url("+this.image+")"),this.div=a,this.div.view=this},update:function(){},addToBody:function(){document.body.appendChild(this.div)},addSubview:function(a){this.subviews.push(a),a.superview=this,this.div.appendChild(a.div)},addActions:function(){this.div.onmouseover=this.mouseOver.bind(this),this.div.onmouseout=this.mouseOut.bind(this),this.div.onclick=this.onClick.bind(this),this.div.onmousedown=this.mouseDown.bind(this),this.div.onmousemove=this.mouseMove.bind(this),this.div.onmouseup=this.mouseUp.bind(this)},mouseOver:function(){},mouseOut:function(){},onClick:function(){},mouseDown:function(){},mouseMove:function(){},mouseUp:function(){}}),TRView=EPPZView.extend({className:"TRView",top:0,left:0,width:320,height:568,color:"#339d84"},{},EPPZViewPropertyMap),TRScreenView=EPPZView.extend({className:"TRScreenView",top:160,left:80,width:320,height:568,overflow:"hidden",color:"transparent",a:null,b:null,construct:function(){this.super.construct("screen"),this.a=new TRView("a"),this.b=new TRView("b"),this.b.color="teal",this.addSubview(this.a),this.addSubview(this.b)},mouseMove:function(a){x=a.layerX,y=a.layerY,this.a.matrix3D.rotateY(x),this.b.matrix3D.rotateZ(x)}},{},EPPZViewPropertyMap),Matrix3D=Class.extend({m11:1,m12:0,m13:0,m14:0,m21:0,m22:1,m23:0,m24:0,m31:0,m32:0,m33:1,m34:0,m41:0,m42:0,m43:0,m44:1,map:["m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44"],string:"",div:null,construct:function(a){null!=a&&this.enumerateMap(function(b,c){this[b]=a[c]})},update:function(){this.string=this.toCSSString()},toCSSString:function(){return"matrix3d("+this.m11+", "+this.m21+", "+this.m31+", "+this.m41+", "+this.m12+", "+this.m22+", "+this.m32+", "+this.m42+", "+this.m13+", "+this.m23+", "+this.m33+", "+this.m43+", "+this.m14+", "+this.m24+", "+this.m34+", "+this.m44+")"},translate:function(a,b,c){this.m14=a,this.m24=b,this.m34=c,this.update()},translateX:function(a){this.m14=a,this.update()},translateY:function(a){this.m24=a,this.update()},translateZ:function(a){this.m24=a,this.update()},degrees:function(a){return a*(180/Math.PI)},radians:function(a){return a*(Math.PI/180)},rotateX:function(a){radians=this.radians(a),sin=Math.sin(radians),cos=Math.cos(radians),this.m22=cos,this.m23=-sin,this.m32=sin,this.m33=cos,this.update()},rotateY:function(a){radians=this.radians(a),sin=Math.sin(radians),cos=Math.cos(radians),this.m11=cos,this.m13=sin,this.m31=-sin,this.m33=cos,this.update()},rotateZ:function(a){radians=this.radians(a),sin=Math.sin(radians),cos=Math.cos(radians),this.m11=cos,this.m12=-sin,this.m21=sin,this.m22=cos,this.update()}},{identy:function(){return new this}},{string:["div.style.webkitTransform","%"]}),EPPZViewPropertyMap={top:["div.style.top","%px"],left:["div.style.left","%px"],width:["div.style.width","%px"],height:["div.style.height","%px"],color:["div.style.backgroundColor","%"],image:["div.style.backgroundImage","url(%)"],overflow:["div.style.overflow","%"]},EPPZView=Class.extend({className:"EPPZView",id:"",top:0,left:0,widht:0,height:0,color:"black",image:null,overflow:"hidden",matrix3D:null,div:null,superview:null,subviews:[],construct:function(a){this.id=a,this.subviews=[],this.matrix3D=Matrix3D.identy(),this.build(),this.addActions(),this.update(),this.matrix3D.div=this.div},build:function(){var a=elementOfType("div");a.id=this.id,a.className=this.className,a.style.position="absolute",a.style.backgroundColor=this.color,this.image&&(a.style.backgroundImage="url("+this.image+")"),this.div=a,this.div.view=this},update:function(){},addToBody:function(){document.body.appendChild(this.div)},addSubview:function(a){this.subviews.push(a),a.superview=this,this.div.appendChild(a.div)},addActions:function(){this.div.onmouseover=this.mouseOver.bind(this),this.div.onmouseout=this.mouseOut.bind(this),this.div.onclick=this.onClick.bind(this),this.div.onmousedown=this.mouseDown.bind(this),this.div.onmousemove=this.mouseMove.bind(this),this.div.onmouseup=this.mouseUp.bind(this)},mouseOver:function(){},mouseOut:function(){},onClick:function(){},mouseDown:function(){},mouseMove:function(){},mouseUp:function(){}}),TRView=EPPZView.extend({className:"TRView",top:0,left:0,width:320,height:568,color:"#339d84"},{},EPPZViewPropertyMap),TRScene=EPPZView.extend({className:"TRScene",id:"scene",width:480,height:880,color:"transparent",image:"assets/devices/device_iPhone_5S.png",screen:null,construct:function(a){this.super.construct(a),this.screen=new TRScreenView,this.addSubview(this.screen)}},{},EPPZViewPropertyMap),scene=new TRScene;scene.addToBody(),log(scene.matrix3D.toString());